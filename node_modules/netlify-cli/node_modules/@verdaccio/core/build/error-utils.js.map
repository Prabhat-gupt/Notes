{"version":3,"file":"error-utils.js","names":["API_ERROR","PASSWORD_SHORT","MUST_BE_LOGGED","PLUGIN_ERROR","CONFIG_BAD_FORMAT","BAD_USERNAME_PASSWORD","NO_PACKAGE","PACKAGE_CANNOT_BE_ADDED","BAD_DATA","NOT_ALLOWED","NOT_ALLOWED_PUBLISH","INTERNAL_SERVER_ERROR","UNKNOWN_ERROR","NOT_PACKAGE_UPLINK","UPLINK_OFFLINE_PUBLISH","UPLINK_OFFLINE","NOT_MODIFIED_NO_DATA","CONTENT_MISMATCH","NOT_FILE_UPLINK","MAX_USERS_REACHED","VERSION_NOT_EXIST","NO_SUCH_FILE","UNSUPORTED_REGISTRY_CALL","FILE_NOT_FOUND","REGISTRATION_DISABLED","UNAUTHORIZED_ACCESS","BAD_STATUS_CODE","PACKAGE_EXIST","BAD_AUTH_HEADER","WEB_DISABLED","DEPRECATED_BASIC_HEADER","BAD_FORMAT_USER_GROUP","RESOURCE_UNAVAILABLE","BAD_PACKAGE_DATA","USERNAME_PASSWORD_REQUIRED","USERNAME_ALREADY_REGISTERED","SUPPORT_ERRORS","PLUGIN_MISSING_INTERFACE","TFA_DISABLED","STORAGE_NOT_IMPLEMENT","PARAMETERS_NOT_VALID","APP_ERROR","CONFIG_NOT_VALID","PROFILE_ERROR","PASSWORD_VALIDATION","getError","code","message","httpError","createError","getConflict","HTTP_STATUS","CONFLICT","getBadData","customMessage","getBadRequest","BAD_REQUEST","getInternalError","INTERNAL_ERROR","getUnauthorized","UNAUTHORIZED","getForbidden","FORBIDDEN","getServiceUnavailable","SERVICE_UNAVAILABLE","getNotFound","NOT_FOUND","getCode","statusCode"],"sources":["../src/error-utils.ts"],"sourcesContent":["import createError, { HttpError } from 'http-errors';\n\nimport { HTTP_STATUS } from './constants';\n\nexport const API_ERROR = {\n  PASSWORD_SHORT: `The provided password does not pass the validation`,\n  MUST_BE_LOGGED: 'You must be logged in to publish packages.',\n  PLUGIN_ERROR: 'bug in the auth plugin system',\n  CONFIG_BAD_FORMAT: 'config file must be an object',\n  BAD_USERNAME_PASSWORD: 'bad username/password, access denied',\n  NO_PACKAGE: 'no such package available',\n  PACKAGE_CANNOT_BE_ADDED: 'this package cannot be added',\n  BAD_DATA: 'bad data',\n  NOT_ALLOWED: 'not allowed to access package',\n  NOT_ALLOWED_PUBLISH: 'not allowed to publish package',\n  INTERNAL_SERVER_ERROR: 'internal server error',\n  UNKNOWN_ERROR: 'unknown error',\n  NOT_PACKAGE_UPLINK: 'package does not exist on uplink',\n  UPLINK_OFFLINE_PUBLISH: 'one of the uplinks is down, refuse to publish',\n  UPLINK_OFFLINE: 'uplink is offline',\n  NOT_MODIFIED_NO_DATA: 'no data',\n  CONTENT_MISMATCH: 'content length mismatch',\n  NOT_FILE_UPLINK: \"file doesn't exist on uplink\",\n  MAX_USERS_REACHED: 'maximum amount of users reached',\n  VERSION_NOT_EXIST: \"this version doesn't exist\",\n  NO_SUCH_FILE: 'no such file available',\n  UNSUPORTED_REGISTRY_CALL: 'unsupported registry call',\n  FILE_NOT_FOUND: 'File not found',\n  REGISTRATION_DISABLED: 'user registration disabled',\n  UNAUTHORIZED_ACCESS: 'unauthorized access',\n  BAD_STATUS_CODE: 'bad status code',\n  PACKAGE_EXIST: 'this package is already present',\n  BAD_AUTH_HEADER: 'bad authorization header',\n  WEB_DISABLED: 'Web interface is disabled in the config file',\n  DEPRECATED_BASIC_HEADER: 'basic authentication is deprecated, please use JWT instead',\n  BAD_FORMAT_USER_GROUP: 'user groups is different than an array',\n  RESOURCE_UNAVAILABLE: 'resource unavailable',\n  BAD_PACKAGE_DATA: 'bad incoming package data',\n  USERNAME_PASSWORD_REQUIRED: 'username and password is required',\n  USERNAME_ALREADY_REGISTERED: 'username is already registered',\n};\n\nexport const SUPPORT_ERRORS = {\n  PLUGIN_MISSING_INTERFACE: 'the plugin does not provide implementation of the requested feature',\n  TFA_DISABLED: 'the two-factor authentication is not yet supported',\n  STORAGE_NOT_IMPLEMENT: 'the storage does not support token saving',\n  PARAMETERS_NOT_VALID: 'the parameters are not valid',\n};\n\nexport const APP_ERROR = {\n  CONFIG_NOT_VALID: 'CONFIG: it does not look like a valid config file',\n  PROFILE_ERROR: 'profile unexpected error',\n  PASSWORD_VALIDATION: 'not valid password',\n};\n\nexport type VerdaccioError = HttpError & { code: number };\n\nfunction getError(code: number, message: string): VerdaccioError {\n  const httpError = createError(code, message);\n\n  httpError.code = code;\n\n  return httpError as VerdaccioError;\n}\n\nexport function getConflict(message: string = API_ERROR.PACKAGE_EXIST): VerdaccioError {\n  return getError(HTTP_STATUS.CONFLICT, message);\n}\n\nexport function getBadData(customMessage?: string): VerdaccioError {\n  return getError(HTTP_STATUS.BAD_DATA, customMessage || API_ERROR.BAD_DATA);\n}\n\nexport function getBadRequest(customMessage: string): VerdaccioError {\n  return getError(HTTP_STATUS.BAD_REQUEST, customMessage);\n}\n\nexport function getInternalError(customMessage?: string): VerdaccioError {\n  return customMessage\n    ? getError(HTTP_STATUS.INTERNAL_ERROR, customMessage)\n    : getError(HTTP_STATUS.INTERNAL_ERROR, API_ERROR.UNKNOWN_ERROR);\n}\n\nexport function getUnauthorized(message = 'no credentials provided'): VerdaccioError {\n  return getError(HTTP_STATUS.UNAUTHORIZED, message);\n}\n\nexport function getForbidden(message = \"can't use this filename\"): VerdaccioError {\n  return getError(HTTP_STATUS.FORBIDDEN, message);\n}\n\nexport function getServiceUnavailable(\n  message: string = API_ERROR.RESOURCE_UNAVAILABLE\n): VerdaccioError {\n  return getError(HTTP_STATUS.SERVICE_UNAVAILABLE, message);\n}\n\nexport function getNotFound(customMessage?: string): VerdaccioError {\n  return getError(HTTP_STATUS.NOT_FOUND, customMessage || API_ERROR.NO_PACKAGE);\n}\n\nexport function getCode(statusCode: number, customMessage: string): VerdaccioError {\n  return getError(statusCode, customMessage);\n}\n"],"mappings":"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"}