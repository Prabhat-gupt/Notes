{"version":3,"file":"lockfile.js","names":["lockFile","name","callback","Promise","resolve","then","statDir","statfile","lockfile","catch","err"],"sources":["../src/lockfile.ts"],"sourcesContent":["import fs from 'fs';\n\nimport locker from 'lockfile';\nimport { Callback } from '@verdaccio/types';\n\nimport { lockfile, statDir, statfile } from './utils';\n\n/**\n * locks a file by creating a lock file\n * @param name\n * @param callback\n */\nconst lockFile = function(name: string, callback: Callback): void {\n  Promise.resolve()\n    .then(() => {\n      return statDir(name);\n    })\n    .then(() => {\n      return statfile(name);\n    })\n    .then(() => {\n      return lockfile(name);\n    })\n    .then(() => {\n      callback(null);\n    })\n    .catch(err => {\n      callback(err);\n    });\n};\n\nexport { lockFile };\n"],"mappings":";;;;;;;AAKA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAMA,QAAQ,GAAG,UAASC,IAAT,EAAuBC,QAAvB,EAAiD;EAChEC,OAAO,CAACC,OAAR,GACGC,IADH,CACQ,MAAM;IACV,OAAO,IAAAC,cAAA,EAAQL,IAAR,CAAP;EACD,CAHH,EAIGI,IAJH,CAIQ,MAAM;IACV,OAAO,IAAAE,eAAA,EAASN,IAAT,CAAP;EACD,CANH,EAOGI,IAPH,CAOQ,MAAM;IACV,OAAO,IAAAG,eAAA,EAASP,IAAT,CAAP;EACD,CATH,EAUGI,IAVH,CAUQ,MAAM;IACVH,QAAQ,CAAC,IAAD,CAAR;EACD,CAZH,EAaGO,KAbH,CAaSC,GAAG,IAAI;IACZR,QAAQ,CAACQ,GAAD,CAAR;EACD,CAfH;AAgBD,CAjBD"}