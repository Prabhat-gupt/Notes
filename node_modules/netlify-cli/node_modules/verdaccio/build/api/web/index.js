"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = _default;
exports.loadTheme = loadTheme;
exports.validatePrimaryColor = validatePrimaryColor;
var _debug = _interopRequireDefault(require("debug"));
var _express = _interopRequireDefault(require("express"));
var _fs = _interopRequireDefault(require("fs"));
var _lodash = _interopRequireDefault(require("lodash"));
var _path = _interopRequireDefault(require("path"));
var _constants = require("../../lib/constants");
var _logger = require("../../lib/logger");
var _pluginLoader = _interopRequireDefault(require("../../lib/plugin-loader"));
var _search = _interopRequireDefault(require("../../lib/search"));
var _utils = require("../../lib/utils");
var _renderHTML = _interopRequireDefault(require("./html/renderHTML"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
const {
  setSecurityWebHeaders
} = require('../middleware');
const debug = (0, _debug.default)('verdaccio');
function loadTheme(config) {
  if (_lodash.default.isNil(config.theme) === false) {
    return _lodash.default.head((0, _pluginLoader.default)(config, config.theme, {}, function (plugin) {
      return plugin.staticPath && plugin.manifest && plugin.manifestFiles;
    }, 'verdaccio-theme'));
  }
}
function validatePrimaryColor(primaryColor) {
  const isHex = /^#+([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/i.test(primaryColor);
  if (!isHex) {
    debug('invalid primary color %o', primaryColor);
    return;
  }
  return primaryColor;
}
const sendFileCallback = next => err => {
  if (!err) {
    return;
  }
  if (err.status === _constants.HTTP_STATUS.NOT_FOUND) {
    next();
  } else {
    next(err);
  }
};
function _default(config, auth, storage) {
  var _config$web, _config$web2;
  let {
    staticPath,
    manifest,
    manifestFiles
  } = loadTheme(config) || require('@verdaccio/ui-theme')();
  debug('static path %o', staticPath);
  _search.default.configureStorage(storage);

  /* eslint new-cap:off */
  const router = _express.default.Router();
  // run in production mode by default, just in case
  // it shouldn't make any difference anyway
  router.use(auth.webUIJWTmiddleware());
  router.use(setSecurityWebHeaders);

  // static assets
  router.get('/-/static/*', function (req, res, next) {
    const filename = req.params[0];
    const file = `${staticPath}/${filename}`;
    debug('render static file %o', file);
    res.sendFile(file, sendFileCallback(next));
  });

  // logo
  if (config !== null && config !== void 0 && (_config$web = config.web) !== null && _config$web !== void 0 && _config$web.logo && !(0, _utils.isHTTPProtocol)(config === null || config === void 0 ? void 0 : (_config$web2 = config.web) === null || _config$web2 === void 0 ? void 0 : _config$web2.logo)) {
    // URI related to a local file
    const absoluteLocalFile = _path.default.posix.resolve(config.web.logo);
    debug('serve local logo %s', absoluteLocalFile);
    try {
      if (_fs.default.existsSync(absoluteLocalFile) && typeof _fs.default.accessSync(absoluteLocalFile, _fs.default.constants.R_OK) === 'undefined') {
        // Note: `path.join` will break on Windows, because it transforms `/` to `\`
        // Use POSIX version `path.posix.join` instead.
        config.web.logo = _path.default.posix.join('/-/static/', _path.default.basename(config.web.logo));
        router.get(config.web.logo, function (_req, res, next) {
          // @ts-ignore
          debug('serve custom logo  web:%s - local:%s', config.web.logo, absoluteLocalFile);
          res.sendFile(absoluteLocalFile, sendFileCallback(next));
        });
        debug('enabled custom logo %s', config.web.logo);
      } else {
        config.web.logo = undefined;
        _logger.logger.warn(`web logo is wrong, path ${absoluteLocalFile} does not exist or is not readable`);
      }
    } catch {
      config.web.logo = undefined;
      _logger.logger.warn(`web logo is wrong, path ${absoluteLocalFile} does not exist or is not readable`);
    }
  }
  router.get('/-/web/:section/*', function (req, res) {
    (0, _renderHTML.default)(config, manifest, manifestFiles, req, res);
    debug('render html section');
  });
  router.get('/', function (req, res, next) {
    (0, _renderHTML.default)(config, manifest, manifestFiles, req, res);
    debug('render root');
  });
  return router;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZXRTZWN1cml0eVdlYkhlYWRlcnMiLCJyZXF1aXJlIiwiZGVidWciLCJidWlsZERlYnVnIiwibG9hZFRoZW1lIiwiY29uZmlnIiwiXyIsImlzTmlsIiwidGhlbWUiLCJoZWFkIiwibG9hZFBsdWdpbiIsInBsdWdpbiIsInN0YXRpY1BhdGgiLCJtYW5pZmVzdCIsIm1hbmlmZXN0RmlsZXMiLCJ2YWxpZGF0ZVByaW1hcnlDb2xvciIsInByaW1hcnlDb2xvciIsImlzSGV4IiwidGVzdCIsInNlbmRGaWxlQ2FsbGJhY2siLCJuZXh0IiwiZXJyIiwic3RhdHVzIiwiSFRUUF9TVEFUVVMiLCJOT1RfRk9VTkQiLCJhdXRoIiwic3RvcmFnZSIsIlNlYXJjaCIsImNvbmZpZ3VyZVN0b3JhZ2UiLCJyb3V0ZXIiLCJleHByZXNzIiwiUm91dGVyIiwidXNlIiwid2ViVUlKV1RtaWRkbGV3YXJlIiwiZ2V0IiwicmVxIiwicmVzIiwiZmlsZW5hbWUiLCJwYXJhbXMiLCJmaWxlIiwic2VuZEZpbGUiLCJ3ZWIiLCJsb2dvIiwiaXNIVFRQUHJvdG9jb2wiLCJhYnNvbHV0ZUxvY2FsRmlsZSIsInBhdGgiLCJwb3NpeCIsInJlc29sdmUiLCJmcyIsImV4aXN0c1N5bmMiLCJhY2Nlc3NTeW5jIiwiY29uc3RhbnRzIiwiUl9PSyIsImpvaW4iLCJiYXNlbmFtZSIsIl9yZXEiLCJ1bmRlZmluZWQiLCJsb2dnZXIiLCJ3YXJuIiwicmVuZGVySFRNTCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hcGkvd2ViL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBidWlsZERlYnVnIGZyb20gJ2RlYnVnJztcbmltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuaW1wb3J0IHsgQ29uZmlnIH0gZnJvbSAnQHZlcmRhY2Npby90eXBlcyc7XG5cbmltcG9ydCB7IEhUVFBfU1RBVFVTIH0gZnJvbSAnLi4vLi4vbGliL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuLi8uLi9saWIvbG9nZ2VyJztcbmltcG9ydCBsb2FkUGx1Z2luIGZyb20gJy4uLy4uL2xpYi9wbHVnaW4tbG9hZGVyJztcbmltcG9ydCBTZWFyY2ggZnJvbSAnLi4vLi4vbGliL3NlYXJjaCc7XG5pbXBvcnQgeyBpc0hUVFBQcm90b2NvbCB9IGZyb20gJy4uLy4uL2xpYi91dGlscyc7XG5pbXBvcnQgcmVuZGVySFRNTCBmcm9tICcuL2h0bWwvcmVuZGVySFRNTCc7XG5cbmNvbnN0IHsgc2V0U2VjdXJpdHlXZWJIZWFkZXJzIH0gPSByZXF1aXJlKCcuLi9taWRkbGV3YXJlJyk7XG5cbmNvbnN0IGRlYnVnID0gYnVpbGREZWJ1ZygndmVyZGFjY2lvJyk7XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2FkVGhlbWUoY29uZmlnKSB7XG4gIGlmIChfLmlzTmlsKGNvbmZpZy50aGVtZSkgPT09IGZhbHNlKSB7XG4gICAgcmV0dXJuIF8uaGVhZChcbiAgICAgIGxvYWRQbHVnaW4oXG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgY29uZmlnLnRoZW1lLFxuICAgICAgICB7fSxcbiAgICAgICAgZnVuY3Rpb24gKHBsdWdpbikge1xuICAgICAgICAgIHJldHVybiBwbHVnaW4uc3RhdGljUGF0aCAmJiBwbHVnaW4ubWFuaWZlc3QgJiYgcGx1Z2luLm1hbmlmZXN0RmlsZXM7XG4gICAgICAgIH0sXG4gICAgICAgICd2ZXJkYWNjaW8tdGhlbWUnXG4gICAgICApXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQcmltYXJ5Q29sb3IocHJpbWFyeUNvbG9yKSB7XG4gIGNvbnN0IGlzSGV4ID0gL14jKyhbYS1mQS1GMC05XXs2fXxbYS1mQS1GMC05XXszfSkkL2kudGVzdChwcmltYXJ5Q29sb3IpO1xuICBpZiAoIWlzSGV4KSB7XG4gICAgZGVidWcoJ2ludmFsaWQgcHJpbWFyeSBjb2xvciAlbycsIHByaW1hcnlDb2xvcik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcmV0dXJuIHByaW1hcnlDb2xvcjtcbn1cblxuY29uc3Qgc2VuZEZpbGVDYWxsYmFjayA9IChuZXh0KSA9PiAoZXJyKSA9PiB7XG4gIGlmICghZXJyKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChlcnIuc3RhdHVzID09PSBIVFRQX1NUQVRVUy5OT1RfRk9VTkQpIHtcbiAgICBuZXh0KCk7XG4gIH0gZWxzZSB7XG4gICAgbmV4dChlcnIpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoY29uZmlnOiBDb25maWcsIGF1dGgsIHN0b3JhZ2UpIHtcbiAgbGV0IHsgc3RhdGljUGF0aCwgbWFuaWZlc3QsIG1hbmlmZXN0RmlsZXMgfSA9XG4gICAgbG9hZFRoZW1lKGNvbmZpZykgfHwgcmVxdWlyZSgnQHZlcmRhY2Npby91aS10aGVtZScpKCk7XG4gIGRlYnVnKCdzdGF0aWMgcGF0aCAlbycsIHN0YXRpY1BhdGgpO1xuICBTZWFyY2guY29uZmlndXJlU3RvcmFnZShzdG9yYWdlKTtcblxuICAvKiBlc2xpbnQgbmV3LWNhcDpvZmYgKi9cbiAgY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcbiAgLy8gcnVuIGluIHByb2R1Y3Rpb24gbW9kZSBieSBkZWZhdWx0LCBqdXN0IGluIGNhc2VcbiAgLy8gaXQgc2hvdWxkbid0IG1ha2UgYW55IGRpZmZlcmVuY2UgYW55d2F5XG4gIHJvdXRlci51c2UoYXV0aC53ZWJVSUpXVG1pZGRsZXdhcmUoKSk7XG4gIHJvdXRlci51c2Uoc2V0U2VjdXJpdHlXZWJIZWFkZXJzKTtcblxuICAvLyBzdGF0aWMgYXNzZXRzXG4gIHJvdXRlci5nZXQoJy8tL3N0YXRpYy8qJywgZnVuY3Rpb24gKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgY29uc3QgZmlsZW5hbWUgPSByZXEucGFyYW1zWzBdO1xuICAgIGNvbnN0IGZpbGUgPSBgJHtzdGF0aWNQYXRofS8ke2ZpbGVuYW1lfWA7XG4gICAgZGVidWcoJ3JlbmRlciBzdGF0aWMgZmlsZSAlbycsIGZpbGUpO1xuICAgIHJlcy5zZW5kRmlsZShmaWxlLCBzZW5kRmlsZUNhbGxiYWNrKG5leHQpKTtcbiAgfSk7XG5cbiAgLy8gbG9nb1xuICBpZiAoY29uZmlnPy53ZWI/LmxvZ28gJiYgIWlzSFRUUFByb3RvY29sKGNvbmZpZz8ud2ViPy5sb2dvKSkge1xuICAgIC8vIFVSSSByZWxhdGVkIHRvIGEgbG9jYWwgZmlsZVxuICAgIGNvbnN0IGFic29sdXRlTG9jYWxGaWxlID0gcGF0aC5wb3NpeC5yZXNvbHZlKGNvbmZpZy53ZWIubG9nbyk7XG4gICAgZGVidWcoJ3NlcnZlIGxvY2FsIGxvZ28gJXMnLCBhYnNvbHV0ZUxvY2FsRmlsZSk7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChcbiAgICAgICAgZnMuZXhpc3RzU3luYyhhYnNvbHV0ZUxvY2FsRmlsZSkgJiZcbiAgICAgICAgdHlwZW9mIGZzLmFjY2Vzc1N5bmMoYWJzb2x1dGVMb2NhbEZpbGUsIGZzLmNvbnN0YW50cy5SX09LKSA9PT0gJ3VuZGVmaW5lZCdcbiAgICAgICkge1xuICAgICAgICAvLyBOb3RlOiBgcGF0aC5qb2luYCB3aWxsIGJyZWFrIG9uIFdpbmRvd3MsIGJlY2F1c2UgaXQgdHJhbnNmb3JtcyBgL2AgdG8gYFxcYFxuICAgICAgICAvLyBVc2UgUE9TSVggdmVyc2lvbiBgcGF0aC5wb3NpeC5qb2luYCBpbnN0ZWFkLlxuICAgICAgICBjb25maWcud2ViLmxvZ28gPSBwYXRoLnBvc2l4LmpvaW4oJy8tL3N0YXRpYy8nLCBwYXRoLmJhc2VuYW1lKGNvbmZpZy53ZWIubG9nbykpO1xuICAgICAgICByb3V0ZXIuZ2V0KGNvbmZpZy53ZWIubG9nbywgZnVuY3Rpb24gKF9yZXEsIHJlcywgbmV4dCkge1xuICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICBkZWJ1Zygnc2VydmUgY3VzdG9tIGxvZ28gIHdlYjolcyAtIGxvY2FsOiVzJywgY29uZmlnLndlYi5sb2dvLCBhYnNvbHV0ZUxvY2FsRmlsZSk7XG4gICAgICAgICAgcmVzLnNlbmRGaWxlKGFic29sdXRlTG9jYWxGaWxlLCBzZW5kRmlsZUNhbGxiYWNrKG5leHQpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRlYnVnKCdlbmFibGVkIGN1c3RvbSBsb2dvICVzJywgY29uZmlnLndlYi5sb2dvKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbmZpZy53ZWIubG9nbyA9IHVuZGVmaW5lZDtcbiAgICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgICAgYHdlYiBsb2dvIGlzIHdyb25nLCBwYXRoICR7YWJzb2x1dGVMb2NhbEZpbGV9IGRvZXMgbm90IGV4aXN0IG9yIGlzIG5vdCByZWFkYWJsZWBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIHtcbiAgICAgIGNvbmZpZy53ZWIubG9nbyA9IHVuZGVmaW5lZDtcbiAgICAgIGxvZ2dlci53YXJuKGB3ZWIgbG9nbyBpcyB3cm9uZywgcGF0aCAke2Fic29sdXRlTG9jYWxGaWxlfSBkb2VzIG5vdCBleGlzdCBvciBpcyBub3QgcmVhZGFibGVgKTtcbiAgICB9XG4gIH1cblxuICByb3V0ZXIuZ2V0KCcvLS93ZWIvOnNlY3Rpb24vKicsIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICAgIHJlbmRlckhUTUwoY29uZmlnLCBtYW5pZmVzdCwgbWFuaWZlc3RGaWxlcywgcmVxLCByZXMpO1xuICAgIGRlYnVnKCdyZW5kZXIgaHRtbCBzZWN0aW9uJyk7XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoJy8nLCBmdW5jdGlvbiAocmVxLCByZXMsIG5leHQpIHtcbiAgICByZW5kZXJIVE1MKGNvbmZpZywgbWFuaWZlc3QsIG1hbmlmZXN0RmlsZXMsIHJlcSwgcmVzKTtcbiAgICBkZWJ1ZygncmVuZGVyIHJvb3QnKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHJvdXRlcjtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7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